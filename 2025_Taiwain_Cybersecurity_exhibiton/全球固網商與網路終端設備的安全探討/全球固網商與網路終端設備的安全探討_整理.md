# 全球固網商與網路終端設備的安全探討

## 研究背景與重要性

### Residential Gateway (RG) 簡介
- 家庭網路終端設備
- 全球約80%家庭都有此設備
- 全球數量估計至少1億台
- 分布：北美、巴西、中國、俄羅斯、澳洲、德國等地

### 研究動機
- 設備普及率高，是攻擊者的理想目標
- 前人的研究發現多個安全問題：
  - Sver先生(英國)：管理機制問題
  - Jesser和C先生(荷蘭)：管理界面對外開放問題
  - CRY先生(美國)：遠端管理設定錯誤問題

## 研究方法

### 測試方法論
- 從使用者角度出發
- 設備拆解分析
- 研究基礎建設架構
- 研究9家不同廠商的設備

## 案例研究

### Case 1: Broadcom Gen 3設備
- 特點：
  - 安全開機與信任根機制
  - 全磁碟加密(FDE)
  - 802.1x認證機制
- 研究過程：
  - 通過中國論壇找到韌體
  - 發現私有協定漏洞
  - 可提取FDE金鑰和802.1x金鑰
- 影響：
  - 可未經授權連接設備到固定網路
  - 可作為Rogue RG/ONU使用

### Case 2: 跨參考iptables與服務
- 發現：
  - 特定IP範圍可通過WAN訪問管理界面
  - 僅阻擋ICMP請求
- 攻擊路徑：
  - 將LAN轉為WAN
  - 通過DVR的RCE漏洞
  - 影響約400萬台設備

### SDK問題
- 發現：
  - 隱身模式問題
  - CMS CLI中的命令注入漏洞
- 影響：
  - 多個廠商使用相同SDK
  - 可能影響大量設備

## 安全建議

### 終端使用者
- 在RG後方部署防火牆
- 封鎖私有地址範圍的入站流量
- 設定RG為"現代模式"(禁用路由功能)

### 電信營運商
- 在控制層面檢測異常流量
- 實施完整性檢查機制
- 監控管理流量模式

### OEM廠商
- 遵循安全標準：
  - 硬體支援的安全開機
  - 正確使用TrustZone
  - FIPS 140-2
  - ISO/IEC 62443 4-2 Level >=2
  - EN 303 645
- 實施安全開發流程

### SoC供應商
- 提供清晰的使用說明
- 實施安全編碼實踐
- 確保程式碼的穩健性 