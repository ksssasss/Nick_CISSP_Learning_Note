
**簡報文件：固定網路營運商與網路終端設備的安全探討**

**日期：** 202年5月23日 **來源：** 音源檔案 "全球固網商與網路終端設備的安全探討.m4a" **主講人：** (未具名)

**摘要：**

這份簡報探討了固定網路（固網）營運商提供的終端設備（通常稱為 [Resident Gateway, RG]）的安全問題。研究發現，全球大量使用的此類設備存在普遍的安全漏洞，這些漏洞不僅影響個人家庭用戶，更對國家關鍵基礎設施構成潛在威脅。主講人透過對全球九個國家、十四個電信商的設備進行研究，發現了多種攻擊手法，並強調了設備製造商、營運商和終端用戶在提升安全方面的責任與可能的改進措施。

**主要主題與重點：**

1. **研究對象：Resident Gateway (RG) 的普遍性與吸引力：**

- 研究的重點是電信商提供的網路終端設備，通常被稱為 Resident Gateway (RG)。
- RG 扮演著將用戶家中的網路連接到外部網路的角色，並可能提供防火牆等額外功能。
- RG 的普及率非常高，一項研究指出全球約 **八成** 的家庭擁有此類設備，其普及程度可與微波爐相比。
- 對於攻擊者而言，RG 是非常有吸引力的目標，因為「打下來之後非常的 **有利可圖**」。

1. **終端設備數量的龐大：**

- 雖然精確數字難以獲得，但主講人找到的一項數據顯示全球至少有 **「一億減 300 萬台」** 這類設備。
- 這些設備在全球範圍內分佈廣泛，主要集中在北美、巴西、中國、俄羅斯、澳洲和歐洲等地。

1. **過往研究與啟發：**

- 過往已有研究人員對類似設備的安全問題進行過探討：
- 約11年前，一位研究人員在英國發現電信商的管理機制可能被攻破。
- 在荷蘭，研究人員發現某些設備的設定導致管理介面暴露於外部網路，並存在漏洞允許遠端程式執行。
- 2024年，一位研究人員對美國某電信商進行研究，發現其遠端管理設定錯誤，可能導致控制該電信商下屬的所有終端設備。
- 這些前人的研究啟發了主講人進行更廣泛的全球性研究。

1. **研究發現：普遍存在安全問題：**

- 主講人對橫跨九個國家、約十四個電信商的設備進行了研究。
- 研究結論「很遺憾的這這個研究的結果看起來是他們都不太安全。」
- 發現的問題包括但不限於：
- 程式碼中存在容易遭受 [**命令注入 (command injection)**] 或 [**反序列化攻擊**] 的漏洞，讓人彷彿回到「2004年一樣」。
- 多個電信商將其管理介面暴露在網際網路上，甚至「你現在就可以繼續對他們進行測試」。
- 存在所謂的 **信任錨點問題 (trusted anchor problem)**，意味著在某些電信商的設備中可能存在一些被「背書」的設備。

1. **研究方法：從使用者端逆向工程：**

- 由於無法接觸到電信商端的設備，主講人採取了從使用者端設備進行 **拆解、逆向工程和評估** 的方式。
- 目的是了解電信商的基礎建設和管理機制是如何設計的。

1. **案例一：先進保護技術的錯誤實作導致物理程式執行：**

- 該設備使用了包含安全啟動和韌體更新機制的第三方晶片架構（主講人稱為「com 第三代」）。
- 電信商實作了 **802.1X 認證**，要求用戶連接固網需要憑證。這可能是因為該公司先預設安裝線路。
- 設備的硬體保護做得「非常晚善非常好」，使得通過傳統逆向工程困難。
- 然而，主講人通過研究國外論壇（特別提到中國的「三古線論壇」）和尋找舊版韌體，成功獲取並解密了韌體。
- 通過 USB 連接並輸入「非常多 **字符**」，發現了一個 **物理程式執行 (physical code execution)** 的漏洞。
- 這個漏洞允許取出儲存在 **TrustZone (T-zone)** 中的敏感資料，這表明該晶片廠商和OEM（設備製造商）在整合時可能存在失誤。
- 提取的敏感資料（如憑證）可能被用於在該電信商網路上控制任意受管設備。

1. **光纖網路 (GPON) 的潛在攻擊面：**

- 研究探討了 GPON 網路的運作方式以及可能的攻擊點。
- **上行 (Upstream)**：由於多個用戶共享同一分光器，攻擊者若能控制發送時機和功率，可能導致同一個分光器下的所有用戶無法上網，即 **阻斷服務攻擊 (Denial of Service, DoS)**。這違反了 GPON 標準 (984.3) 中關於使用不同時槽或波長的要求。
- **下行 (Downstream)**：理論上，下行流量會廣播給所有用戶，但正確實作的終端設備會忽略不屬於自己的封包。此外，設備會交換加密密鑰，使得竊聽其他用戶的流量困難，除非攻擊者能力非常高。
- **管理通道的脆弱性：** 電信商通常使用遠端管理機制（如 TR-069 系統）來管理 RG。這些管理流量通常是通過正常網路通道傳輸的。如果攻擊者能夠控制 RG 並連接到這些管理通道，他們就可以自由操作這些設備。
- 某些電信商將管理功能或特殊功能放在特殊的虛擬通道 (virtual channel) 裡，如果能連接任意 RG，就可以操作這些通道。
- GPON 網路使用了多種協定，可能存在針對這些協定的漏洞。

1. **案例二：教科書級別的錯誤設計與廣泛影響：**

- 案例二是一個「完美教科書等級的說不要怎麼去設計一個設備的狀況」。
- 此類問題在研究的設備中佔比很高，「大約超過三分之二」。
- 問題包括：
- 極少進行 **輸入驗證 (input validation)**，就像「他們在用 2000年的 **程式碼** 一樣」。
- 不進行 **記憶體保護 (memory protection)**。
- 程式碼寫作方式糟糕，常使用不安全的函數（如 system() 與未經驗證的輸入結合）。
- 很多情況下，「你拿起 **設備** 把它放到鍵盤上，你就可以拿到一個 shell」。
- 儘管 Case 2 的漏洞通常在內網（LAN 端）才能利用，且需要高權限認證。
- 主講人發現了繞過這些限制的方法：
- 存在奇怪的防火牆規則，使得「有些 **網路段** 比其他人更平等」，可以存取管理介面。
- 設備封鎖了部分協定，但仍有其他協定可用於偵測和識別設備。
- 發現了 **通用的後門密碼 (common password)**，利用此密碼可以取得高權限密碼的部分資訊，進而推算出高權限使用者的密碼。
- 因此，只要能從外網接觸到管理介面，就可以利用通用密碼獲取高權限，再利用程式碼漏洞進行遠端程式執行。
- 主講人發現許多電信商（「有複數家的電信商」）存在這種錯誤設定，將管理介面暴露在外網。
- 在 Case 2 的特定情況下，該網段中還有其他設備，如 DVR。主講人研究了該 DVR 的程式碼，發現存在遠端程式執行漏洞。
- 攻擊流程：從外網接觸 DVR -> 攻破 DVR 取得內網存取 -> 利用通用密碼和漏洞取得 RG 的高權限 -> 在 RG 上進行遠端程式執行 -> 控制該電信商下所有受影響的設備。
- 這個漏洞在報告時影響了約 **400萬台** 設備，但該電信商的反應和修補速度「非常快」，約兩週內完成。

1. **案例三：第三方 SDK 的通用漏洞導致大規模影響：**

- 某個「非常有名的晶片製造商」(S 製造商) 的 **SDK (Software Development Kit)** 存在通用漏洞。
- 該 SDK 中一個用於設定防火牆規則的函數存在 **命令注入問題**，因為它將用戶輸入與系統命令結合，且未進行充分驗證。
- 廠家（OEM）在開發時「看不太看這個文件」，將這個函數隨意連接到程式碼中，導致「一整個到處都有 **命令注入** 產生」的嚴重問題。
- 由於幾乎所有使用該晶片商 SDK 的設備都會使用這個檔案，因此「幾乎每一台都有這個漏洞」。
- 此漏洞導致了 **隱身模式問題** (stealth mode, 攻擊者利用漏洞後難以被發現) 和 **大量命令注入問題**。
- 主講人將問題回報給該晶片製造商，他們的修補速度「非常快」，約 **22天** 內完成修補並通知所有廠家。

1. **國家安全層面的影響：**

- RG 的安全問題對國家安全構成嚴重威脅。
- 潛在攻擊情境包括：
- 被用於發布 **假消息 (fake news)**，尤其是在軍事演習等敏感時期（提到台灣四月初的情況，發現發布假消息的來源設備「似乎都是一些有問題的設備」）。
- 被用於進行 **網路攻擊**，特別是目前中國的一些網軍組織「非常喜歡使用這類的簽度型聯網設備進行攻擊」。
- 若被攻破，使用者完全不知情，因為他們不會主動去檢查這些設備的日誌。
- 在戰爭或衝突狀態下，攻擊者可能利用這些漏洞「拿下你們國家裡面非常多的終端設備」並「癱瘓你的通訊」。
- 通訊中斷可能導致無法撥打電話、叫救護車或求救，影響民生和應急響應。
- 台灣的關鍵基礎設施定義有八大領域，許多領域依賴網路。網路中斷可能導致連「最簡單的轉錢或領錢」都無法進行。

1. **改進措施與建議：**

- **終端使用者 (家用或公司)：**很難自行偵測設備是否被入侵，因為攻擊者可能會更新韌體，且設備缺乏檢測機制。
- 建議在 RG 後方放置一個防火牆 (firewall)。
- 建議阻止所有來自外網的連線嘗試 (drop/block incoming connections)，這可以幫助抵禦針對 RG 的外網攻擊。
- 可以嘗試將 RG 設定為只作為橋接器 (bridge mode)，而不是 router/gateway，這在某些國家可以避免其管理介面暴露。
- **電信商 (Telecom Operator) 和 營運商 (Operator)：**應實作 **心跳檢測機制 (heartbeat mechanism)** 來偵測設備是否被修改。定期向設備發送隨機數字，並要求設備返回，若返回不符預期，則可能已被入侵。
- 應在其控制層進行 **異常流量偵測**。作為營運商，他們知道正常的管理流量模式，若在非正常時間或有異常流量，則可能正在遭受攻擊。這是第一次攔截機會。
- 攻擊者從外部抓取攻擊包或下載攻擊工具時，會產生流量，這是第二次攔截機會。
- 當攻擊者實際對終端設備發起攻擊時，會產生管理流量，這是第三次攔截機會。
- 在招標或設計新設備時，應考慮 **合規性 (compliance)** 問題。
- 應要求設備支援 **安全啟動 (secure boot)** 和 **妥善利用 (proper utilization)**。這些功能在現代晶片方案中已經存在，但 OEM 可能為節省成本而未開啟。
- 應參考相關安全標準，如 ISO 27036-4/IEC 62443 系列針對 IoT 設備的標準、台灣的 TISI 標準、或 NIST SP 800-53 Rev. 5 等。甚至可以要求更高標準，如 CC (Common Criteria) EAL2+ 等級，但成本較高。
- 應要求製造商進行 **安全開發 (security development)**，並提供 **SDLC (Security Development Lifecycle)** 證明。
- **OEM (設備製造商)：**需要自行實作安全開發流程。
- 需要確保其程式碼不會被客戶（電信商）「拿那把槍，然後射自己」。需要小心使用和整合上游晶片商提供的 SDK。
- **上游晶片製造商 (Software Manufacturer)：**應在文件和教程中清楚說明如何正確使用其 SDK 中的功能，特別是敏感功能，如與系統命令交互的函數。
- 應強調安全啟動等功能的正確使用方式，例如避免在開機時使用不安全的加密解密方式。

**結論：**

這份研究揭示了全球範圍內固定網路終端設備普遍存在的嚴重安全漏洞，這些問題源於設備設計、製造商實作以及電信商配置的多個層面。這些漏洞不僅影響個人用戶的網路安全，更對國家關鍵基礎設施構成實際威脅。主講人強調了各方（晶片商、OEM、電信商、終端用戶）在提升設備安全性方面的責任，並提出了一系列偵測和防禦措施的建議。儘管某些受影響方（如案例二和案例三中的廠商）在漏洞披露後反應迅速並進行了修補，但研究顯示此類問題的普遍性要求業界和監管機構採取更積極的措施，例如要求強制性的安全合規標準和建立定期的安全審計機制。

**後續行動：**

- 主講人預計在今年下半年發布針對此研究的詳細報告。
- 鼓勵對此議題感興趣的人員研讀相關技術規範和廠商產品資料。
- 鼓勵聯絡主講人進行進一步交流。